{% extends "base.html" %}
{% block content %}

<h2 class="mb-4 text-center fw-bold text-primary">User Management</h2>


<!-- Search Box -->
<div class="card shadow-sm mb-4">
  <div class="card-body">
    <form method="GET" action="/" class="row g-2">
      <div class="col-md-10">
        <input type="text" class="form-control" name="search" placeholder="🔍 Search by name or email" value="{{ search_query }}">
      </div>
      <div class="col-md-2 d-grid">
        <button type="submit" class="btn btn-secondary"><i class="bi bi-search"></i> Search</button>
      </div>
    </form>
  </div>
</div>

<!-- Add User Form -->
<div class="card shadow-sm mb-4">
  <div class="card-header bg-success text-white fw-bold">
    ➕ Add New User
  </div>
  <div class="card-body">
    <form method="POST" action="/add" class="row g-3">
      <div class="col-md-5">
        <input type="text" class="form-control" name="name" placeholder="Enter name" required>
      </div>
      <div class="col-md-5">
        <input type="email" class="form-control" name="email" placeholder="Enter email" required>
      </div>
      <div class="col-md-2 d-grid">
        <button type="submit" class="btn btn-success"><i class="bi bi-person-plus"></i> Add</button>
      </div>
    </form>
  </div>
</div>

<!-- User Table -->
<div class="card shadow-sm">
  <div class="card-header bg-dark text-white fw-bold">
    👥 User List
  </div>
  <div class="card-body p-0">
    <table class="table table-hover table-striped mb-0">
      <thead class="table-dark">
        <tr>
          <th style="width: 10%">ID</th>
          <th style="width: 30%">Name</th>
          <th style="width: 40%">Email</th>
          <th style="width: 20%" class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
          <tr>
            <td>{{ user[0] }}</td>
            <td>{{ user[1] }}</td>
            <td>{{ user[2] }}</td>
            <td class="text-center">
              <a href="/update/{{ user[0] }}" class="btn btn-warning btn-sm me-1"><i class="bi bi-pencil-square"></i></a>
              <a href="/delete/{{ user[0] }}" class="btn btn-danger btn-sm"><i class="bi bi-trash"></i></a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Pagination -->
<nav class="mt-3">
  <ul class="pagination justify-content-center">
    {% if page > 1 %}
      <li class="page-item"><a class="page-link" href="?search={{ search_query }}&page={{ page-1 }}">Previous</a></li>
    {% endif %}

    {% for p in range(1, total_pages+1) %}
      <li class="page-item {% if p == page %}active{% endif %}">
        <a class="page-link" href="?search={{ search_query }}&page={{ p }}">{{ p }}</a>
      </li>
    {% endfor %}

    {% if page < total_pages %}
      <li class="page-item"><a class="page-link" href="?search={{ search_query }}&page={{ page+1 }}">Next</a></li>
    {% endif %}
  </ul>
</nav>

{% endblock %}
